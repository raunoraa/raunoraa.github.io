var or=Object.defineProperty;var ur=(t,a,e)=>a in t?or(t,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[a]=e;var kt=(t,a,e)=>ur(t,typeof a!="symbol"?a+"":a,e);import"../chunks/CWj6FrbW.js";import{o as Re}from"../chunks/oqWMDIqs.js";import{aU as sr,aK as lr,a0 as dr,d as cr,k as fr,aN as qe,p as Se,b as ve,R as J,aC as Bt,aD as V,T as q,U as C,aQ as vr,W as ie,X as W,Y as X,a as Le,aO as z,J as Ht,f as p,K as L,aT as wt,aR as Yt,aP as gr}from"../chunks/GhzuZPbW.js";import{s as O,a as De,i as te}from"../chunks/Bx6F5iLl.js";import{g as pr}from"../chunks/sap1Gzqi.js";import{e as ue,f as se,c as Me,u as $t,p as Zt,g as Rt,h as qt,i as Tt,j as Ce,r as Xa,k as za,b as Te,l as It,n as _r,d as mr,o as be,s as hr}from"../chunks/Imq0FHGS.js";import{b as yr}from"../chunks/CbjPuu5r.js";import{_ as br,p as Ot}from"../chunks/Dd8MT0ga.js";import{t as Z,e as xt,i as At}from"../chunks/B0J7BoOv.js";import"../chunks/C8NLdOkt.js";import{i as Pr}from"../chunks/DVXJ7Kgq.js";import{r as Mr,s as Oe,a as Jt}from"../chunks/CNasZ-5C.js";import{L as Sr}from"../chunks/Cwvqw05V.js";function Lr(t,a,e=a){var c=sr();lr(t,"input",r=>{var u=r?t.defaultValue:t.value;if(u=jt(t)?Ut(u):u,e(u),c&&u!==(u=a())){var i=t.selectionStart,o=t.selectionEnd;t.value=u??"",o!==null&&(t.selectionStart=i,t.selectionEnd=Math.min(o,t.value.length))}}),(dr&&t.defaultValue!==t.value||cr(a)==null&&t.value)&&e(jt(t)?Ut(t.value):t.value),fr(()=>{var r=a();jt(t)&&r===Ut(t.value)||t.type==="date"&&!r&&!t.value||r!==t.value&&(t.value=r??"")})}function jt(t){var a=t.type;return a==="number"||a==="range"}function Ut(t){return t===""?null:+t}let Xt=null,Ct=null;async function Ne(){return Ct||(Xt||(Xt=(async()=>{const t=await br(()=>import("../chunks/D-8nYH0_.js"),[],import.meta.url),a=t.Loader||t.default&&t.default.Loader;if(!a)throw new Error("Could not load Google Maps Loader");return Ct=new a({apiKey:"AIzaSyAixRzVqb7kii3XrzzL3OxsN7k_2CoMeaM",version:"weekly"}),Ct})()),Xt)}async function Ha(){return await(await Ne()).importLibrary("core")}async function Ya(){return await(await Ne()).importLibrary("maps")}async function Dr(){return await(await Ne()).importLibrary("marker")}async function kr(){return await(await Ne()).importLibrary("places")}async function ta(){return await(await Ne()).importLibrary("routes")}async function Or(){return await(await Ne()).importLibrary("geometry")}async function Cr(t,a={}){const{Map:e}=await Ya();return new e(t,a)}async function Nt(t){const a=await fetch(t);if(!a.ok)throw new Error(`Failed to fetch ${t}`);const e=await a.text();return`data:image/svg+xml;base64,${btoa(e)}`}function Rr(){ue.set(!0),se.set({key:"ending_session",params:{}}),Xa()}var wr=J('<div class="map-container svelte-zwa6j7"></div> <button class="end-session-button svelte-zwa6j7"> </button> <!>',1);function $r(t,a){Se(a,!0);const[e,c]=De(),r=()=>O(za,"$isDriving",e),u=()=>O(Me,"$carStatus",e),i=()=>O($t,"$userLocation",e),o=()=>O(Zt,"$pathCarToBusStopPickup",e),n=()=>O(Rt,"$pathBusStopPickupToBusStopDestination",e),s=()=>O(qt,"$pathChosenPickupToBusStopPickup",e),d=()=>O(Tt,"$pathBusStopDestinationToChosenDestination",e),l=()=>O(Ce,"$fitBoundsTarget",e),g=()=>O(re,"$endSessionText",e);let _,v=null,y=null,b=null,S=null,D=null,x=null,R=null,M=null,k=null,$=null,I=null,H=null,Q=null;function E(m,P){if(v&&m){const T={path:"M 0,-1 0,1",strokeOpacity:1,scale:4},B={path:H,strokeOpacity:1,scale:4},h={path:Q,strokeOpacity:1,scale:4};return P?m.setOptions({strokeOpacity:0,icons:[{icon:T,offset:"0",repeat:"20px"},{icon:B,offset:"0",repeat:"0"},{icon:h,offset:"100%",repeat:"0"}],visible:!1,map:v,zIndex:1}):m.setOptions({strokeColor:"#FF0000",strokeWeight:4,icons:[{icon:B,offset:"0",repeat:"0"},{icon:h,offset:"100%",repeat:"0"}],visible:!1,map:v}),m.setMap(v),m}return null}function G(m,P){if(!P||P.length<2)return{index:0,progress:0};let T=1/0,B=0,h=0;for(let f=0;f<P.length-1;f++){const w=P[f],A=P[f+1],N=F(m,w,A),j=Y(w,A,N),ce=google.maps.geometry.spherical.computeDistanceBetween(m,j);ce<T&&(T=ce,B=f,h=N)}return{index:B,progress:h}}function F(m,P,T){const B=P.lat(),h=P.lng(),f=T.lat(),w=T.lng(),A=m.lat(),N=m.lng(),j=w-h,ce=f-B,Pe=j*j+ce*ce;if(Pe===0)return 0;const we=((N-h)*j+(A-B)*ce)/Pe;return Math.max(0,Math.min(1,we))}function Y(m,P,T){const B=m.lat()+(P.lat()-m.lat())*T,h=m.lng()+(P.lng()-m.lng())*T;return new google.maps.LatLng(B,h)}function ee(m,P,T,B){if(!m||!v)return P;const h=m.getPath().getArray();if(h.length<2)return P;const{index:f,progress:w}=G(T,h),A=[];for(let N=0;N<=f;N++)A.push(h[N]);if(w>0&&f<h.length-1){const N=Y(h[f],h[f+1],w);A.push(N)}if(!P){let N="#FF0000";r()&&(N="#00AA00"),P=new google.maps.Polyline({map:v,strokeColor:N,strokeWeight:4,strokeOpacity:1,zIndex:1})}return P.setPath(A),P}Re(async()=>{var f;ue.set(!0),se.set({key:"loading_map",params:{}}),v=await Cr(_,{center:{lat:58.378,lng:26.729},zoom:13,disableDefaultUI:!0,mapId:"DEMO_MAP_ID"});const{AdvancedMarkerElement:m}=await Dr(),{SymbolPath:P}=await Ha();await Or(),H=P.CIRCLE,Q=P.FORWARD_OPEN_ARROW,$=await Nt("/usermarker.svg"),I=await Nt("/carmarker.svg");const T=document.createElement("img");T.src=I,T.style.width="48px",T.style.height="48px",k=new m({position:(f=u())==null?void 0:f.pose,map:v,content:T});const B=document.createElement("img");B.src=$,B.style.width="32px",B.style.height="32px",M=new m({map:v,content:B});const{Polyline:h}=await Ya();y=E(new h,!0),b=E(new h,!1),S=E(new h,!0),D=E(new h,!1),x=null,R=null,ue.set(!1),se.set({key:"loading",params:{}})}),ve(()=>{i()&&M&&(M.position=i())}),ve(()=>{var m;if((m=u())!=null&&m.pose&&k){k.position=u().pose;const P=new google.maps.LatLng(u().pose.lat,u().pose.lng);D&&o()&&(R=ee(D,R,P)),b&&n()&&(x=ee(b,x,P))}}),ve(()=>{i()&&M&&(M.position=i())}),ve(()=>{s()&&y?(y.setPath(s().pathArray),y.setVisible(!0)):y!=null&&y.getVisible()&&y.setVisible(!1)}),ve(()=>{n()&&b?(b.setPath(n().pathArray),b.setVisible(!0)):b!=null&&b.getVisible()&&(b.setVisible(!1),x&&(x.setMap(null),x=null))}),ve(()=>{d()&&S?(S.setPath(d().pathArray),S.setVisible(!0)):S!=null&&S.getVisible()&&S.setVisible(!1)}),ve(()=>{o()&&D?(D.setPath(o().pathArray),D.setVisible(!0)):D!=null&&D.getVisible()&&(D.setVisible(!1),R&&(R.setMap(null),R=null))}),ve(()=>{var m,P,T,B,h,f,w;if(l()==="all"){if((m=s())!=null&&m.bounds&&((P=n())!=null&&P.bounds)&&((T=d())!=null&&T.bounds)){const A=s().bounds.union(n().bounds).union(d().bounds);v==null||v.fitBounds(A)}}else l()==="pickup"?(B=s())!=null&&B.bounds&&(v==null||v.fitBounds(s().bounds)):l()==="destination"?(h=d())!=null&&h.bounds&&(v==null||v.fitBounds(d().bounds)):l()==="carToPickup"?(f=o())!=null&&f.bounds&&((w=s())!=null&&w.bounds)&&(v==null||v.fitBounds(o().bounds.union(s().bounds))):l()==="default"&&(v==null||v.setCenter({lat:58.378,lng:26.729}),v==null||v.setZoom(13))});const re=Z("end_session_button");var oe=wr(),de=Bt(oe);yr(de,m=>_=m,()=>_);var ne=V(de,2);ne.__click=[Rr];var K=q(ne,!0);C(ne);var pe=V(ne,2);vr(pe,()=>a.children),ie(()=>W(K,g())),X(t,oe),Le(),c()}qe(["click"]);function qr(t,a){var e;ue.set(!0),se.set({key:"loading",params:{}}),(e=a())==null||e.publishState("spot-picking")}var Tr=J('<button class="order-car-button svelte-1e7pabs"> </button>');function xr(t,a){Se(a,!1);const[e,c]=De(),r=()=>O(Te,"$mqttClient",e),u=()=>O(i,"$orderCarText",e),i=Z("order_car_button");Pr();var o=Tr();o.__click=[qr,r];var n=q(o,!0);C(o),ie(()=>W(n,u())),X(t,o),Le(),c()}qe(["click"]);var zt={},Ee={},Ke={},U={},aa;function ge(){if(aa)return U;aa=1,Object.defineProperty(U,"__esModule",{value:!0}),U.areaConversion=U.timeConversion=U.distanceConversion=U.altitudeKeys=U.latitudeKeys=U.longitudeKeys=U.MAXLON=U.MINLON=U.MAXLAT=U.MINLAT=U.earthRadius=U.sexagesimalPattern=void 0;var t=/^([0-9]{1,3})°\s*([0-9]{1,3}(?:\.(?:[0-9]{1,}))?)['′]\s*(([0-9]{1,3}(\.([0-9]{1,}))?)["″]\s*)?([NEOSW]?)$/;U.sexagesimalPattern=t;var a=6378137;U.earthRadius=a;var e=-90;U.MINLAT=e;var c=90;U.MAXLAT=c;var r=-180;U.MINLON=r;var u=180;U.MAXLON=u;var i=["lng","lon","longitude",0];U.longitudeKeys=i;var o=["lat","latitude",1];U.latitudeKeys=o;var n=["alt","altitude","elevation","elev",2];U.altitudeKeys=n;var s={m:1,km:.001,cm:100,mm:1e3,mi:1/1609.344,sm:1/1852.216,ft:100/30.48,in:100/2.54,yd:1/.9144};U.distanceConversion=s;var d={m:60,h:3600,d:86400};U.timeConversion=d;var l={m2:1,km2:1e-6,ha:1e-4,a:.01,ft2:10.763911,yd2:1.19599,in2:1550.0031};return U.areaConversion=l,l.sqm=l.m2,l.sqkm=l.km2,l.sqft=l.ft2,l.sqyd=l.yd2,l.sqin=l.in2,U}var We={},ra;function Gt(){if(ra)return We;ra=1,Object.defineProperty(We,"__esModule",{value:!0}),We.default=void 0;var t=function(c,r){return r.reduce(function(u,i){if(typeof c>"u"||c===null)throw new Error("'".concat(c,"' is no valid coordinate."));return Object.prototype.hasOwnProperty.call(c,i)&&typeof i<"u"&&typeof u>"u"?(u=i,i):u},void 0)},a=t;return We.default=a,We}var Ve={},Fe={},na;function Et(){if(na)return Fe;na=1,Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.default=void 0;var t=function(c){var r=c.toString().trim();return isNaN(parseFloat(r))?!1:parseFloat(r)===Number(r)},a=t;return Fe.default=a,Fe}var je={},ia;function Kt(){if(ia)return je;ia=1,Object.defineProperty(je,"__esModule",{value:!0}),je.default=void 0;var t=ge(),a=function(r){return t.sexagesimalPattern.test(r.toString().trim())},e=a;return je.default=e,je}var Ue={},oa;function Wt(){if(oa)return Ue;oa=1,Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.default=void 0;var t=ge(),a=function(r){var u=new RegExp(t.sexagesimalPattern).exec(r.toString().trim());if(typeof u>"u"||u===null)throw new Error("Given value is not in sexagesimal format");var i=Number(u[2])/60||0,o=Number(u[4])/3600||0,n=parseFloat(u[1])+i+o;return["S","W"].includes(u[7])?-n:n},e=a;return Ue.default=e,Ue}var Xe={},ze={},ua;function Qt(){if(ua)return ze;ua=1,Object.defineProperty(ze,"__esModule",{value:!0}),ze.default=void 0;var t=ge(),a=e(Gt());function e(n){return n&&n.__esModule?n:{default:n}}function c(n,s){var d=Object.keys(n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(n);s&&(l=l.filter(function(g){return Object.getOwnPropertyDescriptor(n,g).enumerable})),d.push.apply(d,l)}return d}function r(n){for(var s=1;s<arguments.length;s++){var d=arguments[s]!=null?arguments[s]:{};s%2?c(Object(d),!0).forEach(function(l){u(n,l,d[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(d)):c(Object(d)).forEach(function(l){Object.defineProperty(n,l,Object.getOwnPropertyDescriptor(d,l))})}return n}function u(n,s,d){return s in n?Object.defineProperty(n,s,{value:d,enumerable:!0,configurable:!0,writable:!0}):n[s]=d,n}var i=function(s){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{longitude:t.longitudeKeys,latitude:t.latitudeKeys,altitude:t.altitudeKeys},l=(0,a.default)(s,d.longitude),g=(0,a.default)(s,d.latitude),_=(0,a.default)(s,d.altitude);return r({latitude:g,longitude:l},_?{altitude:_}:{})},o=i;return ze.default=o,ze}var He={},sa;function Za(){if(sa)return He;sa=1,Object.defineProperty(He,"__esModule",{value:!0}),He.default=void 0;var t=r(Et()),a=r(Kt()),e=r(Wt()),c=ge();function r(o){return o&&o.__esModule?o:{default:o}}var u=function o(n){return(0,t.default)(n)?!(parseFloat(n)>c.MAXLAT||n<c.MINLAT):(0,a.default)(n)?o((0,e.default)(n)):!1},i=u;return He.default=i,He}var Ye={},la;function Ja(){if(la)return Ye;la=1,Object.defineProperty(Ye,"__esModule",{value:!0}),Ye.default=void 0;var t=r(Et()),a=r(Kt()),e=r(Wt()),c=ge();function r(o){return o&&o.__esModule?o:{default:o}}var u=function o(n){return(0,t.default)(n)?!(parseFloat(n)>c.MAXLON||n<c.MINLON):(0,a.default)(n)?o((0,e.default)(n)):!1},i=u;return Ye.default=i,Ye}var da;function Qa(){if(da)return Xe;da=1,Object.defineProperty(Xe,"__esModule",{value:!0}),Xe.default=void 0;var t=c(Qt()),a=c(Za()),e=c(Ja());function c(i){return i&&i.__esModule?i:{default:i}}var r=function(o){var n=(0,t.default)(o),s=n.latitude,d=n.longitude;if(Array.isArray(o)&&o.length>=2)return(0,e.default)(o[0])&&(0,a.default)(o[1]);if(typeof s>"u"||typeof d>"u")return!1;var l=o[d],g=o[s];return!(typeof g>"u"||typeof l>"u"||(0,a.default)(g)===!1||(0,e.default)(l)===!1)},u=r;return Xe.default=u,Xe}var ca;function ea(){if(ca)return Ve;ca=1,Object.defineProperty(Ve,"__esModule",{value:!0}),Ve.default=void 0;var t=u(Et()),a=u(Kt()),e=u(Wt()),c=u(Qa()),r=u(Qt());function u(l){return l&&l.__esModule?l:{default:l}}function i(l,g){var _=Object.keys(l);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(l);g&&(v=v.filter(function(y){return Object.getOwnPropertyDescriptor(l,y).enumerable})),_.push.apply(_,v)}return _}function o(l){for(var g=1;g<arguments.length;g++){var _=arguments[g]!=null?arguments[g]:{};g%2?i(Object(_),!0).forEach(function(v){n(l,v,_[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(_)):i(Object(_)).forEach(function(v){Object.defineProperty(l,v,Object.getOwnPropertyDescriptor(_,v))})}return l}function n(l,g,_){return g in l?Object.defineProperty(l,g,{value:_,enumerable:!0,configurable:!0,writable:!0}):l[g]=_,l}var s=function l(g){if((0,t.default)(g))return Number(g);if((0,a.default)(g))return(0,e.default)(g);if((0,c.default)(g)){var _=(0,r.default)(g);return Array.isArray(g)?g.map(function(v,y){return[0,1].includes(y)?l(v):v}):o(o(o({},g),_.latitude&&n({},_.latitude,l(g[_.latitude]))),_.longitude&&n({},_.longitude,l(g[_.longitude])))}return Array.isArray(g)?g.map(function(v){return(0,c.default)(v)?l(v):v}):g},d=s;return Ve.default=d,Ve}var fa;function he(){if(fa)return Ke;fa=1,Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.default=void 0;var t=ge(),a=c(Gt()),e=c(ea());function c(i){return i&&i.__esModule?i:{default:i}}var r=function(o,n){var s=(0,a.default)(o,t.latitudeKeys);if(!(typeof s>"u"||s===null)){var d=o[s];return n===!0?d:(0,e.default)(d)}},u=r;return Ke.default=u,Ke}var Ze={},va;function ye(){if(va)return Ze;va=1,Object.defineProperty(Ze,"__esModule",{value:!0}),Ze.default=void 0;var t=ge(),a=c(Gt()),e=c(ea());function c(i){return i&&i.__esModule?i:{default:i}}var r=function(o,n){var s=(0,a.default)(o,t.longitudeKeys);if(!(typeof s>"u"||s===null)){var d=o[s];return n===!0?d:(0,e.default)(d)}},u=r;return Ze.default=u,Ze}var Je={},ga;function ke(){if(ga)return Je;ga=1,Object.defineProperty(Je,"__esModule",{value:!0}),Je.default=void 0;var t=function(c){return c*Math.PI/180},a=t;return Je.default=a,Je}var Qe={},pa;function Be(){if(pa)return Qe;pa=1,Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.default=void 0;var t=function(c){return c*180/Math.PI},a=t;return Qe.default=a,Qe}var _a;function Ar(){if(_a)return Ee;_a=1,Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.default=void 0;var t=u(he()),a=u(ye()),e=u(ke()),c=u(Be()),r=ge();function u(n){return n&&n.__esModule?n:{default:n}}var i=function(s,d,l){var g=arguments.length>3&&arguments[3]!==void 0?arguments[3]:6371e3,_=(0,t.default)(s),v=(0,a.default)(s),y=d/g,b=(0,e.default)(l),S=(0,e.default)(_),D=(0,e.default)(v),x=Math.asin(Math.sin(S)*Math.cos(y)+Math.cos(S)*Math.sin(y)*Math.cos(b)),R=D+Math.atan2(Math.sin(b)*Math.sin(y)*Math.cos(S),Math.cos(y)-Math.sin(S)*Math.sin(x)),M=(0,c.default)(R);return(M<r.MINLON||M>r.MAXLON)&&(R=(R+3*Math.PI)%(2*Math.PI)-Math.PI,M=(0,c.default)(R)),{latitude:(0,c.default)(x),longitude:M}},o=i;return Ee.default=o,Ee}var et={},ma;function Nr(){if(ma)return et;ma=1,Object.defineProperty(et,"__esModule",{value:!0}),et.default=void 0;var t=ge(),a=function(r){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"m",i=t.areaConversion[u];if(i)return r*i;throw new Error("Invalid unit used for area conversion.")},e=a;return et.default=e,et}var tt={},ha;function Br(){if(ha)return tt;ha=1,Object.defineProperty(tt,"__esModule",{value:!0}),tt.default=void 0;var t=ge(),a=function(r){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"m",i=t.distanceConversion[u];if(i)return r*i;throw new Error("Invalid unit used for distance conversion.")},e=a;return tt.default=e,tt}var at={},ya;function Ir(){if(ya)return at;ya=1,Object.defineProperty(at,"__esModule",{value:!0}),at.default=void 0;var t=ge(),a=function(r){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"kmh";switch(u){case"kmh":return r*t.timeConversion.h*t.distanceConversion.km;case"mph":return r*t.timeConversion.h*t.distanceConversion.mi;default:return r}},e=a;return at.default=e,at}var rt={},ba;function Gr(){if(ba)return rt;ba=1,Object.defineProperty(rt,"__esModule",{value:!0}),rt.default=void 0;function t(s,d){return u(s)||r(s,d)||e(s,d)||a()}function a(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function e(s,d){if(s){if(typeof s=="string")return c(s,d);var l=Object.prototype.toString.call(s).slice(8,-1);if(l==="Object"&&s.constructor&&(l=s.constructor.name),l==="Map"||l==="Set")return Array.from(s);if(l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l))return c(s,d)}}function c(s,d){(d==null||d>s.length)&&(d=s.length);for(var l=0,g=new Array(d);l<d;l++)g[l]=s[l];return g}function r(s,d){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(s)))){var l=[],g=!0,_=!1,v=void 0;try{for(var y=s[Symbol.iterator](),b;!(g=(b=y.next()).done)&&(l.push(b.value),!(d&&l.length===d));g=!0);}catch(S){_=!0,v=S}finally{try{!g&&y.return!=null&&y.return()}finally{if(_)throw v}}return l}}function u(s){if(Array.isArray(s))return s}var i=function(d){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,g=Math.pow(10,l);return Math.round(d*g)/g},o=function(d){var l=d.toString().split("."),g=t(l,2),_=g[0],v=g[1],y=Math.abs(Number(_)),b=+("0."+(v||0))*60,S=b.toString().split("."),D=Math.floor(b),x=i(+("0."+(S[1]||0))*60).toString(),R=x.split("."),M=t(R,2),k=M[0],$=M[1],I=$===void 0?"0":$;return y+"° "+D.toString().padStart(2,"0")+"' "+k.padStart(2,"0")+"."+I.padEnd(1,"0")+'"'},n=o;return rt.default=n,rt}var nt={},it={},ot={},ut={},Pa;function er(){if(Pa)return ut;Pa=1,Object.defineProperty(ut,"__esModule",{value:!0}),ut.default=void 0;var t=function(c){return c>1?1:c<-1?-1:c},a=t;return ut.default=a,ut}var Ma;function xe(){if(Ma)return ot;Ma=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.default=void 0;var t=u(he()),a=u(ye()),e=u(ke()),c=u(er()),r=ge();function u(n){return n&&n.__esModule?n:{default:n}}var i=function(s,d){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;l=typeof l<"u"&&!isNaN(l)?l:1;var g=(0,t.default)(s),_=(0,a.default)(s),v=(0,t.default)(d),y=(0,a.default)(d),b=Math.acos((0,c.default)(Math.sin((0,e.default)(v))*Math.sin((0,e.default)(g))+Math.cos((0,e.default)(v))*Math.cos((0,e.default)(g))*Math.cos((0,e.default)(_)-(0,e.default)(y))))*r.earthRadius;return Math.round(b/l)*l},o=i;return ot.default=o,ot}var Sa;function tr(){if(Sa)return it;Sa=1,Object.defineProperty(it,"__esModule",{value:!0}),it.default=void 0;var t=a(xe());function a(r){return r&&r.__esModule?r:{default:r}}var e=function(u,i){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.default;return o=typeof o=="function"?o:t.default,i.slice().sort(function(n,s){return o(u,n)-o(u,s)})},c=e;return it.default=c,it}var La;function Er(){if(La)return nt;La=1,Object.defineProperty(nt,"__esModule",{value:!0}),nt.default=void 0;var t=a(tr());function a(r){return r&&r.__esModule?r:{default:r}}var e=function(u,i){return(0,t.default)(u,i)[0]},c=e;return nt.default=c,nt}var st={},Da;function Kr(){if(Da)return st;Da=1,Object.defineProperty(st,"__esModule",{value:!0}),st.default=void 0;var t=r(ke()),a=r(he()),e=r(ye()),c=ge();function r(o){return o&&o.__esModule?o:{default:o}}var u=function(n){var s=0;if(n.length>2){for(var d,l,g,_=0;_<n.length;_++){_===n.length-2?(d=n.length-2,l=n.length-1,g=0):_===n.length-1?(d=n.length-1,l=0,g=1):(d=_,l=_+1,g=_+2);var v=(0,e.default)(n[d]),y=(0,a.default)(n[l]),b=(0,e.default)(n[g]);s+=((0,t.default)(b)-(0,t.default)(v))*Math.sin((0,t.default)(y))}s=s*c.earthRadius*c.earthRadius/2}return Math.abs(s)},i=u;return st.default=i,st}var lt={},ka;function ar(){if(ka)return lt;ka=1,Object.defineProperty(lt,"__esModule",{value:!0}),lt.default=void 0;var t=e(he()),a=e(ye());function e(u){return u&&u.__esModule?u:{default:u}}var c=function(i){if(Array.isArray(i)===!1||i.length===0)throw new Error("No points were given.");return i.reduce(function(o,n){var s=(0,t.default)(n),d=(0,a.default)(n);return{maxLat:Math.max(s,o.maxLat),minLat:Math.min(s,o.minLat),maxLng:Math.max(d,o.maxLng),minLng:Math.min(d,o.minLng)}},{maxLat:-1/0,minLat:1/0,maxLng:-1/0,minLng:1/0})},r=c;return lt.default=r,lt}var dt={},Oa;function Wr(){if(Oa)return dt;Oa=1,Object.defineProperty(dt,"__esModule",{value:!0}),dt.default=void 0;var t=u(he()),a=u(ye()),e=u(ke()),c=u(Be()),r=ge();function u(n){return n&&n.__esModule?n:{default:n}}var i=function(s,d){var l=(0,t.default)(s),g=(0,a.default)(s),_=(0,e.default)(l),v=(0,e.default)(g),y=d/r.earthRadius,b=_-y,S=_+y,D=(0,e.default)(r.MAXLAT),x=(0,e.default)(r.MINLAT),R=(0,e.default)(r.MAXLON),M=(0,e.default)(r.MINLON),k,$;if(b>x&&S<D){var I=Math.asin(Math.sin(y)/Math.cos(_));k=v-I,k<M&&(k+=Math.PI*2),$=v+I,$>R&&($-=Math.PI*2)}else b=Math.max(b,x),S=Math.min(S,D),k=M,$=R;return[{latitude:(0,c.default)(b),longitude:(0,c.default)(k)},{latitude:(0,c.default)(S),longitude:(0,c.default)($)}]},o=i;return dt.default=o,dt}var ct={},Ca;function Vr(){if(Ca)return ct;Ca=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.default=void 0;var t=r(he()),a=r(ye()),e=r(ke()),c=r(Be());function r(o){return o&&o.__esModule?o:{default:o}}var u=function(n){if(Array.isArray(n)===!1||n.length===0)return!1;var s=n.length,d=n.reduce(function(v,y){var b=(0,e.default)((0,t.default)(y)),S=(0,e.default)((0,a.default)(y));return{X:v.X+Math.cos(b)*Math.cos(S),Y:v.Y+Math.cos(b)*Math.sin(S),Z:v.Z+Math.sin(b)}},{X:0,Y:0,Z:0}),l=d.X/s,g=d.Y/s,_=d.Z/s;return{longitude:(0,c.default)(Math.atan2(g,l)),latitude:(0,c.default)(Math.atan2(_,Math.sqrt(l*l+g*g)))}},i=u;return ct.default=i,ct}var ft={},Ra;function Fr(){if(Ra)return ft;Ra=1,Object.defineProperty(ft,"__esModule",{value:!0}),ft.default=void 0;var t=a(ar());function a(r){return r&&r.__esModule?r:{default:r}}var e=function(u){var i=(0,t.default)(u),o=i.minLat+(i.maxLat-i.minLat)/2,n=i.minLng+(i.maxLng-i.minLng)/2;return{latitude:parseFloat(o.toFixed(6)),longitude:parseFloat(n.toFixed(6))}},c=e;return ft.default=c,ft}var vt={},gt={},wa;function rr(){if(wa)return gt;wa=1,Object.defineProperty(gt,"__esModule",{value:!0}),gt.default=void 0;var t=r(he()),a=r(ye()),e=r(ke()),c=r(Be());function r(o){return o&&o.__esModule?o:{default:o}}var u=function(n,s){var d=(0,e.default)((0,a.default)(s))-(0,e.default)((0,a.default)(n)),l=Math.log(Math.tan((0,e.default)((0,t.default)(s))/2+Math.PI/4)/Math.tan((0,e.default)((0,t.default)(n))/2+Math.PI/4));return Math.abs(d)>Math.PI&&(d>0?d=(Math.PI*2-d)*-1:d=Math.PI*2+d),((0,c.default)(Math.atan2(d,l))+360)%360},i=u;return gt.default=i,gt}var $a;function jr(){if($a)return vt;$a=1,Object.defineProperty(vt,"__esModule",{value:!0}),vt.default=void 0;var t=a(rr());function a(r){return r&&r.__esModule?r:{default:r}}var e=function(u,i){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.default,n=typeof o=="function"?o(u,i):(0,t.default)(u,i);if(isNaN(n))throw new Error("Could not calculate bearing for given points. Check your bearing function");switch(Math.round(n/22.5)){case 1:return"NNE";case 2:return"NE";case 3:return"ENE";case 4:return"E";case 5:return"ESE";case 6:return"SE";case 7:return"SSE";case 8:return"S";case 9:return"SSW";case 10:return"SW";case 11:return"WSW";case 12:return"W";case 13:return"WNW";case 14:return"NW";case 15:return"NNW";default:return"N"}},c=e;return vt.default=c,vt}var pt={},qa;function nr(){if(qa)return pt;qa=1,Object.defineProperty(pt,"__esModule",{value:!0}),pt.default=void 0;var t=e(xe()),a=e(er());function e(u){return u&&u.__esModule?u:{default:u}}var c=function(i,o,n){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,d=(0,t.default)(o,i,s),l=(0,t.default)(i,n,s),g=(0,t.default)(o,n,s),_=Math.acos((0,a.default)((d*d+g*g-l*l)/(2*d*g))),v=Math.acos((0,a.default)((l*l+g*g-d*d)/(2*l*g)));return _>Math.PI/2?d:v>Math.PI/2?l:Math.sin(_)*d},r=c;return pt.default=r,pt}var _t={},Ta;function Ur(){if(Ta)return _t;Ta=1,Object.defineProperty(_t,"__esModule",{value:!0}),_t.default=void 0;var t=r(he()),a=r(ye()),e=r(ke()),c=r(Be());function r(o){return o&&o.__esModule?o:{default:o}}var u=function(n,s){var d=(0,t.default)(s),l=(0,a.default)(s),g=(0,t.default)(n),_=(0,a.default)(n),v=((0,c.default)(Math.atan2(Math.sin((0,e.default)(l)-(0,e.default)(_))*Math.cos((0,e.default)(d)),Math.cos((0,e.default)(g))*Math.sin((0,e.default)(d))-Math.sin((0,e.default)(g))*Math.cos((0,e.default)(d))*Math.cos((0,e.default)(l)-(0,e.default)(_))))+360)%360;return v},i=u;return _t.default=i,_t}var mt={},xa;function Xr(){if(xa)return mt;xa=1,Object.defineProperty(mt,"__esModule",{value:!0}),mt.default=void 0;var t=a(xe());function a(u){return u&&u.__esModule?u:{default:u}}function e(u){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?e=function(o){return typeof o}:e=function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},e(u)}var c=function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t.default;return i.reduce(function(n,s){return e(n)==="object"&&n.last!==null&&(n.distance+=o(s,n.last)),n.last=s,n},{last:null,distance:0}).distance},r=c;return mt.default=r,mt}var ht={},Aa;function zr(){if(Aa)return ht;Aa=1,Object.defineProperty(ht,"__esModule",{value:!0}),ht.default=void 0;var t=r(he()),a=r(ye()),e=r(ke()),c=ge();function r(o){return o&&o.__esModule?o:{default:o}}var u=function(n,s){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;d=typeof d<"u"&&!isNaN(d)?d:1;var l=(0,t.default)(n),g=(0,a.default)(n),_=(0,t.default)(s),v=(0,a.default)(s),y=6356752314245e-6,b=1/298.257223563,S=(0,e.default)(v-g),D,x,R,M,k,$,I=Math.atan((1-b)*Math.tan((0,e.default)(parseFloat(l)))),H=Math.atan((1-b)*Math.tan((0,e.default)(parseFloat(_)))),Q=Math.sin(I),E=Math.cos(I),G=Math.sin(H),F=Math.cos(H),Y=S,ee,re=100;do{var oe=Math.sin(Y),de=Math.cos(Y);if($=Math.sqrt(F*oe*(F*oe)+(E*G-Q*F*de)*(E*G-Q*F*de)),$===0)return 0;D=Q*G+E*F*de,x=Math.atan2($,D),R=E*F*oe/$,M=1-R*R,k=D-2*Q*G/M,isNaN(k)&&(k=0);var ne=b/16*M*(4+b*(4-3*M));ee=Y,Y=S+(1-ne)*b*R*(x+ne*$*(k+ne*D*(-1+2*k*k)))}while(Math.abs(Y-ee)>1e-12&&--re>0);if(re===0)return NaN;var K=M*(c.earthRadius*c.earthRadius-y*y)/(y*y),pe=1+K/16384*(4096+K*(-768+K*(320-175*K))),m=K/1024*(256+K*(-128+K*(74-47*K))),P=m*$*(k+m/4*(D*(-1+2*k*k)-m/6*k*(-3+4*$*$)*(-3+4*k*k))),T=y*pe*(x-P);return Math.round(T/d)*d},i=u;return ht.default=i,ht}var yt={},Na;function Hr(){if(Na)return yt;Na=1,Object.defineProperty(yt,"__esModule",{value:!0}),yt.default=void 0;var t=function(c){if(/^(NNE|NE|NNW|N)$/.test(c))return"N";if(/^(ENE|E|ESE|SE)$/.test(c))return"E";if(/^(SSE|S|SSW|SW)$/.test(c))return"S";if(/^(WSW|W|WNW|NW)$/.test(c))return"W"},a=t;return yt.default=a,yt}var bt={},Ba;function Yr(){if(Ba)return bt;Ba=1,Object.defineProperty(bt,"__esModule",{value:!0}),bt.default=void 0;var t=a(xe());function a(r){return r&&r.__esModule?r:{default:r}}var e=function(u,i){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.default,n=o(u,i),s=Number(i.time)-Number(u.time),d=n/s*1e3;return d},c=e;return bt.default=c,bt}var Pt={},Ia;function Zr(){if(Ia)return Pt;Ia=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.default=void 0;var t=a(xe());function a(r){return r&&r.__esModule?r:{default:r}}var e=function(u,i,o){return(0,t.default)(i,u)+(0,t.default)(u,o)===(0,t.default)(i,o)},c=e;return Pt.default=c,Pt}var Mt={},Ga;function Jr(){if(Ga)return Mt;Ga=1,Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.default=void 0;var t=e(he()),a=e(ye());function e(u){return u&&u.__esModule?u:{default:u}}var c=function(i,o){for(var n=!1,s=o.length,d=-1,l=s-1;++d<s;l=d)((0,a.default)(o[d])<=(0,a.default)(i)&&(0,a.default)(i)<(0,a.default)(o[l])||(0,a.default)(o[l])<=(0,a.default)(i)&&(0,a.default)(i)<(0,a.default)(o[d]))&&(0,t.default)(i)<((0,t.default)(o[l])-(0,t.default)(o[d]))*((0,a.default)(i)-(0,a.default)(o[d]))/((0,a.default)(o[l])-(0,a.default)(o[d]))+(0,t.default)(o[d])&&(n=!n);return n},r=c;return Mt.default=r,Mt}var St={},Ea;function Qr(){if(Ea)return St;Ea=1,Object.defineProperty(St,"__esModule",{value:!0}),St.default=void 0;var t=a(nr());function a(r){return r&&r.__esModule?r:{default:r}}var e=function(u,i,o,n){return(0,t.default)(u,i,o)<n},c=e;return St.default=c,St}var Lt={},Ka;function en(){if(Ka)return Lt;Ka=1,Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.default=void 0;var t=a(xe());function a(r){return r&&r.__esModule?r:{default:r}}var e=function(u,i,o){var n=.01;return(0,t.default)(u,i,n)<o},c=e;return Lt.default=c,Lt}var Dt={},Wa;function tn(){if(Wa)return Dt;Wa=1,Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.default=void 0;function t(n,s){return u(n)||r(n,s)||e(n,s)||a()}function a(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function e(n,s){if(n){if(typeof n=="string")return c(n,s);var d=Object.prototype.toString.call(n).slice(8,-1);if(d==="Object"&&n.constructor&&(d=n.constructor.name),d==="Map"||d==="Set")return Array.from(n);if(d==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d))return c(n,s)}}function c(n,s){(s==null||s>n.length)&&(s=n.length);for(var d=0,l=new Array(s);d<s;d++)l[d]=n[d];return l}function r(n,s){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(n)))){var d=[],l=!0,g=!1,_=void 0;try{for(var v=n[Symbol.iterator](),y;!(l=(y=v.next()).done)&&(d.push(y.value),!(s&&d.length===s));l=!0);}catch(b){g=!0,_=b}finally{try{!l&&v.return!=null&&v.return()}finally{if(g)throw _}}return d}}function u(n){if(Array.isArray(n))return n}var i=function(s){if(!s.startsWith("POLYGON"))throw new Error("Invalid wkt.");var d=s.slice(s.indexOf("(")+2,s.indexOf(")")).split(", "),l=d.map(function(g){var _=g.split(" "),v=t(_,2),y=v[0],b=v[1];return{longitude:parseFloat(y),latitude:parseFloat(b)}});return l},o=i;return Dt.default=o,Dt}var Va;function an(){return Va||(Va=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});var a={computeDestinationPoint:!0,convertArea:!0,convertDistance:!0,convertSpeed:!0,decimalToSexagesimal:!0,findNearest:!0,getAreaOfPolygon:!0,getBounds:!0,getBoundsOfDistance:!0,getCenter:!0,getCenterOfBounds:!0,getCompassDirection:!0,getCoordinateKey:!0,getCoordinateKeys:!0,getDistance:!0,getDistanceFromLine:!0,getGreatCircleBearing:!0,getLatitude:!0,getLongitude:!0,getPathLength:!0,getPreciseDistance:!0,getRhumbLineBearing:!0,getRoughCompassDirection:!0,getSpeed:!0,isDecimal:!0,isPointInLine:!0,isPointInPolygon:!0,isPointNearLine:!0,isPointWithinRadius:!0,isSexagesimal:!0,isValidCoordinate:!0,isValidLatitude:!0,isValidLongitude:!0,orderByDistance:!0,sexagesimalToDecimal:!0,toDecimal:!0,toRad:!0,toDeg:!0,wktToPolygon:!0};Object.defineProperty(t,"computeDestinationPoint",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(t,"convertArea",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"convertDistance",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"convertSpeed",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"decimalToSexagesimal",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"findNearest",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"getAreaOfPolygon",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"getBounds",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"getBoundsOfDistance",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"getCenter",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"getCenterOfBounds",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(t,"getCompassDirection",{enumerable:!0,get:function(){return _.default}}),Object.defineProperty(t,"getCoordinateKey",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(t,"getCoordinateKeys",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(t,"getDistance",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(t,"getDistanceFromLine",{enumerable:!0,get:function(){return S.default}}),Object.defineProperty(t,"getGreatCircleBearing",{enumerable:!0,get:function(){return D.default}}),Object.defineProperty(t,"getLatitude",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(t,"getLongitude",{enumerable:!0,get:function(){return R.default}}),Object.defineProperty(t,"getPathLength",{enumerable:!0,get:function(){return M.default}}),Object.defineProperty(t,"getPreciseDistance",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(t,"getRhumbLineBearing",{enumerable:!0,get:function(){return $.default}}),Object.defineProperty(t,"getRoughCompassDirection",{enumerable:!0,get:function(){return I.default}}),Object.defineProperty(t,"getSpeed",{enumerable:!0,get:function(){return H.default}}),Object.defineProperty(t,"isDecimal",{enumerable:!0,get:function(){return Q.default}}),Object.defineProperty(t,"isPointInLine",{enumerable:!0,get:function(){return E.default}}),Object.defineProperty(t,"isPointInPolygon",{enumerable:!0,get:function(){return G.default}}),Object.defineProperty(t,"isPointNearLine",{enumerable:!0,get:function(){return F.default}}),Object.defineProperty(t,"isPointWithinRadius",{enumerable:!0,get:function(){return Y.default}}),Object.defineProperty(t,"isSexagesimal",{enumerable:!0,get:function(){return ee.default}}),Object.defineProperty(t,"isValidCoordinate",{enumerable:!0,get:function(){return re.default}}),Object.defineProperty(t,"isValidLatitude",{enumerable:!0,get:function(){return oe.default}}),Object.defineProperty(t,"isValidLongitude",{enumerable:!0,get:function(){return de.default}}),Object.defineProperty(t,"orderByDistance",{enumerable:!0,get:function(){return ne.default}}),Object.defineProperty(t,"sexagesimalToDecimal",{enumerable:!0,get:function(){return K.default}}),Object.defineProperty(t,"toDecimal",{enumerable:!0,get:function(){return pe.default}}),Object.defineProperty(t,"toRad",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(t,"toDeg",{enumerable:!0,get:function(){return P.default}}),Object.defineProperty(t,"wktToPolygon",{enumerable:!0,get:function(){return T.default}});var e=h(Ar()),c=h(Nr()),r=h(Br()),u=h(Ir()),i=h(Gr()),o=h(Er()),n=h(Kr()),s=h(ar()),d=h(Wr()),l=h(Vr()),g=h(Fr()),_=h(jr()),v=h(Gt()),y=h(Qt()),b=h(xe()),S=h(nr()),D=h(Ur()),x=h(he()),R=h(ye()),M=h(Xr()),k=h(zr()),$=h(rr()),I=h(Hr()),H=h(Yr()),Q=h(Et()),E=h(Zr()),G=h(Jr()),F=h(Qr()),Y=h(en()),ee=h(Kt()),re=h(Qa()),oe=h(Za()),de=h(Ja()),ne=h(tr()),K=h(Wt()),pe=h(ea()),m=h(ke()),P=h(Be()),T=h(tn()),B=ge();Object.keys(B).forEach(function(f){f==="default"||f==="__esModule"||Object.prototype.hasOwnProperty.call(a,f)||Object.defineProperty(t,f,{enumerable:!0,get:function(){return B[f]}})});function h(f){return f&&f.__esModule?f:{default:f}}}(zt)),zt}var rn=an();class nn{constructor(){kt(this,"stops",[])}async instantiate(){const e=await(await fetch("/stops.json")).json();this.stops=e.stops,console.log("Stops loaded:",JSON.stringify(this.stops))}findClosestStops(a,e=.5,c=3){return this.stops.map(i=>{const o=rn.getDistance({latitude:a[0],longitude:a[1]},{latitude:i.position.lat,longitude:i.position.lng})/1e3;return{name:i.name,position:i.position,dist_from_point:o}}).filter(i=>i.dist_from_point<=e).sort((i,o)=>i.dist_from_point-o.dist_from_point).slice(0,c)}}var on=J('<label for="spot-search-input"> </label>'),un=(t,a)=>L(a,!0),sn=J('<button type="button" class="clear-searchbar svelte-94s185" aria-label="Clear"><img src="/clearsearchbar.svg" alt="Clear" class="clear-searchbar-icon svelte-94s185"/></button>'),ln=J('<div class="loading"> </div>'),dn=J('<li><button type="button" class="suggestion-item svelte-94s185"><div class="suggestion-name-text"> </div> <div class="secondary-suggestion-text"> </div></button></li>'),cn=J('<li><div class="suggestion-item svelte-94s185"><div class="suggestion-name-text"> </div></div></li>'),fn=(t,a,e)=>a(p(e)),vn=J('<div class="secondary-suggestion-text"> </div>'),gn=J('<li><button type="button" class="suggestion-item svelte-94s185"><div class="suggestion-name-text"> </div> <!></button></li>'),pn=J('<ul class="suggestions-list"><!> <!></ul>'),_n=J('<div class="spot-search-bar"><!> <div class="searchbar-wrapper svelte-94s185"><input id="spot-search-input" type="text"/> <!></div> <!> <!></div>');function Fa(t,a){Se(a,!0);const[e,c]=De(),r=()=>O(It,"$locale",e),u=()=>O($t,"$userLocation",e),i=()=>O(R,"$yourLocationMessage",e),o=()=>O(k,"$loadingText",e),n=()=>O(M,"$yourLocationErrorMessage",e);let s=z(""),d=z(Ht([])),l=z(!1),g=null,_=z(!1),v=null,y=Ot(a,"label",3,""),b=Ot(a,"placeholder",3,""),S=Ot(a,"error",3,!1),D=Ot(a,"value",3,"");Re(async()=>{const{AutocompleteSuggestion:m}=await kr();g=m});async function x(m){var P;if(g){L(l,!0);const T={input:m.input,includedRegionCodes:["ee"],region:"ee",language:r()},B=await g.fetchAutocompleteSuggestions(T);let h=[];if(B.suggestions&&B.suggestions.length>0)for(const f of B.suggestions){let w=await f.placePrediction.toPlace().fetchFields({fields:["location"]});h.push({name:f.placePrediction.mainText.text,secondaryText:((P=f.placePrediction.secondaryText)==null?void 0:P.text)??"",position:{lat:w.place.location.lat(),lng:w.place.location.lng()}})}return L(l,!1),h}return[]}ve(()=>{p(s)?x({input:p(s)}).then(m=>{L(d,m,!0)}):L(d,[],!0)}),ve(()=>{D()!==void 0&&D()!==null&&L(s,D())});const R=Z("your_location"),M=Z("your_location_error"),k=Z("loading");function $(m){var P;v=m,L(s,m.name,!0),L(_,!1),(P=a.onSelect)==null||P.call(a,m)}function I(){var P;if(!u())return;const m={name:i(),position:{lat:u().lat,lng:u().lng},secondaryText:`${u().lat}, ${u().lng}`};v=m,L(s,m.name,!0),L(_,!1),(P=a.onSelect)==null||P.call(a,m)}function H(){L(_,!1),v&&p(s)!==v.name&&L(s,v.name,!0)}function Q(){var m;L(s,""),v=null,L(d,[],!0),L(_,!1),(m=a.onSelect)==null||m.call(a,null)}var E=_n(),G=q(E);{var F=m=>{var P=on(),T=q(P,!0);C(P),ie(()=>W(T,y())),X(m,P)};te(G,m=>{y()&&m(F)})}var Y=V(G,2),ee=q(Y);Mr(ee),ee.__click=[un,_];var re=V(ee,2);{var oe=m=>{var P=sn();P.__click=Q,X(m,P)};te(re,m=>{p(s)&&m(oe)})}C(Y);var de=V(Y,2);{var ne=m=>{var P=ln(),T=q(P,!0);C(P),ie(()=>W(T,o())),X(m,P)};te(de,m=>{p(l)&&m(ne)})}var K=V(de,2);{var pe=m=>{var P=pn(),T=q(P);{var B=w=>{var A=dn(),N=q(A);N.__mousedown=I;var j=q(N),ce=q(j,!0);C(j);var Pe=V(j,2),we=q(Pe);C(Pe),C(N),C(A),ie(()=>{W(ce,i()),W(we,`${u().lat??""}, ${u().lng??""}`)}),X(w,A)},h=w=>{var A=cn(),N=q(A),j=q(N),ce=q(j,!0);C(j),C(N),C(A),ie(()=>W(ce,n())),X(w,A)};te(T,w=>{u()?w(B):w(h,!1)})}var f=V(T,2);xt(f,17,()=>p(d),At,(w,A)=>{var N=gn(),j=q(N);j.__mousedown=[fn,$,A];var ce=q(j),Pe=q(ce,!0);C(ce);var we=V(ce,2);{var Vt=Ae=>{var Ie=vn(),Ge=q(Ie,!0);C(Ie),ie(()=>W(Ge,p(A).secondaryText)),X(Ae,Ie)};te(we,Ae=>{p(A).secondaryText&&Ae(Vt)})}C(j),C(N),ie(()=>W(Pe,p(A).name)),X(w,N)}),C(P),X(m,P)};te(K,m=>{p(_)&&m(pe)})}C(E),ie(()=>{Oe(ee,"placeholder",b()),Jt(ee,1,`spot-search ${S()?"error":""}`,"svelte-94s185")}),wt("focus",ee,()=>L(_,!0)),wt("blur",ee,H),Lr(ee,()=>p(s),m=>L(s,m)),X(t,E),Le(),c()}qe(["click","mousedown"]);function mn(t,a){var e,c;ue.set(!0),se.set({key:"loading",params:{}}),(e=a())==null||e.publishClearChosenSpots(),(c=a())==null||c.publishState("map-idle")}var hn=J('<div class="no-stops-message"> </div>'),yn=J('<div class="no-stops-message"> </div>'),bn=(t,a)=>{L(a,!1)},Pn=J("<button> </button>"),Mn=J('<button class="cancel-button"> </button> <div class="spot-picking-container"><!> <!> <!> <!> <!></div>',1);function Sn(t,a){Se(a,!0);const[e,c]=De(),r=()=>O(Te,"$mqttClient",e),u=()=>O(Me,"$carStatus",e),i=()=>O(M,"$cancelButtonText",e),o=()=>O(k,"$spotPickingPickupLabel",e),n=()=>O($,"$spotPickingPickupPlaceholder",e),s=()=>O(Q,"$noStopsNearPickup",e),d=()=>O(I,"$spotPickingDestinationLabel",e),l=()=>O(H,"$spotPickingDestinationPlaceholder",e),g=()=>O(E,"$noStopsNearDestination",e),_=()=>O(G,"$confirmButtonText",e);let v=z(null),y=z(null),b=z(null),S=z(!1),D=z(!1),x=z(!1),R=z(!1);Re(async()=>{ue.set(!0),se.set({key:"loading",params:{}}),L(v,new nn,!0),await p(v).instantiate(),u()&&u().chosen_spots&&u().chosen_spots.pickup&&u().chosen_spots.destination&&(L(x,!0),L(y,u().chosen_spots.pickup,!0),L(b,u().chosen_spots.destination,!0)),ue.set(!1),se.set({key:"loading",params:{}})}),ve(()=>{var f,w,A;if(p(y)&&p(b)&&p(v)){let N=p(v).findClosestStops([p(y).position.lat,p(y).position.lng]),j=p(v).findClosestStops([p(b).position.lat,p(b).position.lng]);N.length===0&&L(S,!0),j.length===0&&L(D,!0),N.length>0&&j.length>0&&(L(R,!0),p(x)||(ue.set(!0),se.set({key:"loading",params:{}}),(f=r())==null||f.publishChosenSpots(p(y),p(b)),(w=r())==null||w.publishFoundBusStops(N,j),(A=r())==null||A.publishState("bus-stop-picking")))}});const M=Z("spot_picking_cancel_button"),k=Z("spot_picking_pickup_label"),$=Z("spot_picking_search_placeholder"),I=Z("spot_picking_destination_label"),H=Z("spot_picking_search_placeholder"),Q=Z("spot_pickup_no_bus_stop_found"),E=Z("spot_destination_no_bus_stop_found"),G=Z("spot_picking_confirm");var F=Mn(),Y=Bt(F);Y.__click=[mn,r];var ee=q(Y,!0);C(Y);var re=V(Y,2),oe=q(re);const de=Yt(()=>{var f;return((f=p(y))==null?void 0:f.name)??""});Fa(oe,{get label(){return o()},get placeholder(){return n()},get error(){return p(S)},get value(){return p(de)},onSelect:f=>{L(y,f,!0),L(S,!1)}});var ne=V(oe,2);{var K=f=>{var w=hn(),A=q(w,!0);C(w),ie(()=>W(A,s())),X(f,w)};te(ne,f=>{p(S)&&f(K)})}var pe=V(ne,2);const m=Yt(()=>{var f;return((f=p(b))==null?void 0:f.name)??""});Fa(pe,{get label(){return d()},get placeholder(){return l()},get error(){return p(D)},get value(){return p(m)},onSelect:f=>{L(b,f,!0),L(D,!1)}});var P=V(pe,2);{var T=f=>{var w=yn(),A=q(w,!0);C(w),ie(()=>W(A,g())),X(f,w)};te(P,f=>{p(D)&&f(T)})}var B=V(P,2);{var h=f=>{var w=Pn();w.__click=[bn,x];var A=q(w,!0);C(w),ie(()=>W(A,_())),X(f,w)};te(B,f=>{p(R)&&p(x)&&p(y)&&p(b)&&!p(S)&&!p(D)&&f(h)})}C(re),ie(()=>W(ee,i())),X(t,F),Le(),c()}qe(["click"]);class me{static async initialize(){if(!this.travelModeConstants||!this.directionsStatusConstants){const{TravelMode:a,DirectionsStatus:e}=await ta();this.travelModeConstants=a,this.directionsStatusConstants=e}}static async getRoute(a){await this.initialize();const{DirectionsService:e}=await ta(),r=await new e().route(a);return r.status===this.directionsStatusConstants.OK?{pathArray:r.routes[0].overview_path.map(i=>({lat:i.lat(),lng:i.lng()})),bounds:r.routes[0].bounds}:null}static async calculatePreliminaryRoutes(a,e,c,r="en",u=!0){if(await this.initialize(),!a||!e||!c){console.warn("RouteService: Missing required data for route calculation");return}const i=a;if(!i.pickup||!i.destination){console.warn("RouteService: Invalid chosen spots data");return}const o={origin:{lat:i.pickup.position.lat,lng:i.pickup.position.lng},destination:{lat:e.position.lat,lng:e.position.lng},travelMode:this.travelModeConstants.WALKING,language:r,region:"ee"},n={origin:{lat:e.position.lat,lng:e.position.lng},destination:{lat:c.position.lat,lng:c.position.lng},travelMode:this.travelModeConstants.DRIVING,language:r,region:"ee"},s={origin:{lat:c.position.lat,lng:c.position.lng},destination:{lat:i.destination.position.lat,lng:i.destination.position.lng},travelMode:this.travelModeConstants.WALKING,language:r,region:"ee"};if(u){const[d,l,g]=await Promise.all([this.getRoute(o),this.getRoute(n),this.getRoute(s)]);qt.set(d),Rt.set(l),Tt.set(g)}else{const[d,l]=await Promise.all([this.getRoute(o),this.getRoute(s)]);qt.set(d),Tt.set(l)}}static nullDrivingRoutes(){Rt.set(null),Zt.set(null)}static async calculateCarRouteHelper(a,e){const{LatLngBounds:c}=await Ha(),r=new c;let u=[];if(a)for(const i of a)r.extend({lat:i[0],lng:i[1]}),u.push({lat:i[0],lng:i[1]});else e&&r.extend({lat:e.position.lat,lng:e.position.lng});return{mappedWaypoints:u,latLngBounds:r}}static async calculateCarToPickupRoute(a,e){const{mappedWaypoints:c,latLngBounds:r}=await this.calculateCarRouteHelper(a,e);Zt.set({pathArray:c,bounds:r})}static async calculatePickupBusStopToDestinationRoute(a,e){const{mappedWaypoints:c,latLngBounds:r}=await this.calculateCarRouteHelper(a,e);Rt.set({pathArray:c,bounds:r})}}kt(me,"travelModeConstants",null),kt(me,"directionsStatusConstants",null);function Ln(t,a){var e,c;ue.set(!0),se.set({key:"loading",params:{}}),(e=a())==null||e.publishClearFoundBusStops(),(c=a())==null||c.publishState("spot-picking")}var Dn=(t,a)=>L(a,!p(a)),kn=(t,a,e)=>a(p(e)),On=J('<button type="button" role="option"> </button>'),Cn=J('<div class="dropdown-list" role="listbox" aria-labelledby="pickup-dropdown"></div>'),Rn=(t,a)=>L(a,!p(a)),wn=(t,a,e)=>a(p(e)),$n=J('<button type="button" role="option"> </button>'),qn=J('<div class="dropdown-list" role="listbox" aria-labelledby="destination-dropdown"></div>'),Tn=J('<button class="svelte-6vl3uk"> </button>'),xn=J('<div class="bus-stop-picking svelte-6vl3uk"><div class="dropdown-group"><h2> </h2> <label for="pickup-dropdown"> </label> <div class="custom-dropdown"><button id="pickup-dropdown" type="button" class="dropdown-selected svelte-6vl3uk" aria-haspopup="listbox"> <span class="dropdown-arrow"> </span></button> <!></div></div> <div class="dropdown-group"><label for="destination-dropdown"> </label> <div class="custom-dropdown"><button id="destination-dropdown" type="button" class="dropdown-selected svelte-6vl3uk" aria-haspopup="listbox"> <span class="dropdown-arrow"> </span></button> <!></div></div> <!> <button class="svelte-6vl3uk"> </button></div>');function An(t,a){Se(a,!0);const[e,c]=De(),r=()=>O(Me,"$carStatus",e),u=()=>O(It,"$locale",e),i=()=>O(Te,"$mqttClient",e),o=()=>O(Q,"$busStopPickHeadingText",e),n=()=>O(E,"$busStopPickupText",e),s=()=>O(G,"$busStopDestinationText",e),d=()=>O(I,"$orderCarText",e),l=()=>O(H,"$backButtonText",e);let g=z(!1),_=z(!1),v=z(null),y=z(Ht([])),b=z(Ht([])),S=z(null),D=z(null);Re(async()=>{await me.initialize()}),ve(()=>{r()&&r().found_bus_stops&&r().chosen_spots&&!p(g)&&(L(y,r().found_bus_stops.pickup,!0),L(b,r().found_bus_stops.destination,!0),L(S,p(y)[0],!0),L(D,p(b)[0],!0),L(v,r().chosen_spots,!0),ue.set(!1),se.set({key:"loading",params:{}}),L(g,!0))}),ve(()=>{p(S)&&p(D)&&p(v)&&(me.calculatePreliminaryRoutes(p(v),p(S),p(D),u()),p(_)||(Ce.set("all"),L(_,!0)))});function x(){var ae,le;if(p(S)&&p(D)){ue.set(!0),se.set({key:"loading",params:{}}),(ae=i())==null||ae.publishChosenRouteStops(p(S),p(D)),(le=i())==null||le.publishGoal(p(S).position);const $e=Me.subscribe(_e=>{var fe;_e&&_e.are_waypoints_sent&&(me.nullDrivingRoutes(),(fe=i())==null||fe.publishState("driving-to-pickup"),$e())})}}let R=z(!1),M=z(!1);function k(ae){L(S,ae,!0),L(R,!1),Ce.set("pickup")}function $(ae){L(D,ae,!0),L(M,!1),Ce.set("destination")}const I=Z("order_car_button"),H=Z("bus_stop_back_button"),Q=Z("bus_stop_pick_heading"),E=Z("bus_stop_pickup"),G=Z("bus_stop_destination");var F=xn(),Y=q(F),ee=q(Y),re=q(ee,!0);C(ee);var oe=V(ee,2),de=q(oe,!0);C(oe);var ne=V(oe,2),K=q(ne);K.__click=[Dn,R];var pe=q(K),m=V(pe),P=q(m,!0);C(m),C(K);var T=V(K,2);{var B=ae=>{var le=Cn();xt(le,21,()=>p(y),At,($e,_e)=>{var fe=On();fe.__click=[kn,k,_e];var Ft=q(fe,!0);C(fe),ie(()=>{Jt(fe,1,`dropdown-item ${p(S)&&p(_e).name===p(S).name?"selected":""}`,"svelte-6vl3uk"),Oe(fe,"aria-selected",p(S)&&p(_e).name===p(S).name),W(Ft,p(_e).name)}),X($e,fe)}),C(le),X(ae,le)};te(T,ae=>{p(R)&&ae(B)})}C(ne),C(Y);var h=V(Y,2),f=q(h),w=q(f,!0);C(f);var A=V(f,2),N=q(A);N.__click=[Rn,M];var j=q(N),ce=V(j),Pe=q(ce,!0);C(ce),C(N);var we=V(N,2);{var Vt=ae=>{var le=qn();xt(le,21,()=>p(b),At,($e,_e)=>{var fe=$n();fe.__click=[wn,$,_e];var Ft=q(fe,!0);C(fe),ie(()=>{Jt(fe,1,`dropdown-item ${p(D)&&p(_e).name===p(D).name?"selected":""}`,"svelte-6vl3uk"),Oe(fe,"aria-selected",p(D)&&p(_e).name===p(D).name),W(Ft,p(_e).name)}),X($e,fe)}),C(le),X(ae,le)};te(we,ae=>{p(M)&&ae(Vt)})}C(A),C(h);var Ae=V(h,2);{var Ie=ae=>{var le=Tn();le.__click=x;var $e=q(le,!0);C(le),ie(()=>W($e,d())),X(ae,le)};te(Ae,ae=>{p(S)&&p(D)&&ae(Ie)})}var Ge=V(Ae,2);Ge.__click=[Ln,i];var ir=q(Ge,!0);C(Ge),C(F),ie(()=>{var ae,le;W(re,o()),W(de,n()),Oe(K,"aria-expanded",p(R)),W(pe,`${((ae=p(S))==null?void 0:ae.name)??""} `),W(P,p(R)?"▲":"▼"),W(w,s()),Oe(N,"aria-expanded",p(M)),W(j,`${((le=p(D))==null?void 0:le.name)??""} `),W(Pe,p(M)?"▲":"▼"),W(ir,l())}),X(t,F),Le(),c()}qe(["click"]);function ja(t,a){Se(a,!0);const[e,c]=De(),r=()=>O(Me,"$carStatus",e),u=()=>O(It,"$locale",e),i=()=>O(Te,"$mqttClient",e);Re(async()=>{var o,n,s,d,l,g,_;ue.set(!0),se.set({key:"loading",params:{}}),await me.initialize(),await me.calculatePreliminaryRoutes(((o=r())==null?void 0:o.chosen_spots)??null,((n=r())==null?void 0:n.chosen_route_stops.pickup)??null,((s=r())==null?void 0:s.chosen_route_stops.destination)??null,u(),!1),za.set(!0),a.type=="pickup"?(await me.calculateCarToPickupRoute(((d=r())==null?void 0:d.route)??null,((l=r())==null?void 0:l.chosen_route_stops.pickup)??null),Ce.set("carToPickup")):a.type=="destination"&&(await me.calculatePickupBusStopToDestinationRoute(((g=r())==null?void 0:g.route)??null,((_=r())==null?void 0:_.chosen_route_stops.destination)??null),Ce.set("all")),ue.set(!1),se.set({key:"loading",params:{}})}),ve(()=>{var o,n;r()&&r().are_waypoints_sent&&r().route.length===0&&(a.type==="pickup"?(o=i())==null||o.publishState("arrived-to-pickup"):a.type==="destination"&&((n=i())==null||n.publishState("arrived-to-destination")))}),Le(),c()}var Nn=J('<h2 class="svelte-1a58aos"> </h2> <button class="svelte-1a58aos"> </button>',1);function Ua(t,a){Se(a,!0);const[e,c]=De(),r=()=>O(qt,"$pathChosenPickupToBusStopPickup",e),u=()=>O(Tt,"$pathBusStopDestinationToChosenDestination",e),i=()=>O(Me,"$carStatus",e),o=()=>O(It,"$locale",e),n=()=>O(Te,"$mqttClient",e),s=()=>O(g,"$confirmHeadingMessage",e),d=()=>O(_,"$confirmButtonMessage",e);Re(async()=>{var x,R,M;await me.initialize(),(!r()||!u())&&await me.calculatePreliminaryRoutes(((x=i())==null?void 0:x.chosen_spots)??null,((R=i())==null?void 0:R.chosen_route_stops.pickup)??null,((M=i())==null?void 0:M.chosen_route_stops.destination)??null,o(),!1),a.type=="pickup"?Ce.set("pickup"):a.type=="destination"&&Ce.set("destination")});async function l(){var x,R,M,k,$,I,H;if(ue.set(!0),se.set({key:"loading",params:{}}),(x=n())==null||x.publishClearAreWaypointsSent(),await new Promise(Q=>{var G;if(!((G=i())!=null&&G.are_waypoints_sent)){Q();return}const E=Me.subscribe(F=>{F&&!F.are_waypoints_sent&&(E(),Q())})}),a.type==="pickup"){const Q=(R=i())==null?void 0:R.chosen_route_stops.destination.position;(M=n())==null||M.publishGoal(Q);let E;E=Me.subscribe(G=>{var F;G&&G.are_waypoints_sent&&(me.nullDrivingRoutes(),(F=n())==null||F.publishState("driving-to-destination"),E==null||E())})}else a.type==="destination"&&((k=n())==null||k.publishClearChosenSpots(),($=n())==null||$.publishClearFoundBusStops(),(I=n())==null||I.publishClearChosenRouteStops(),_r(),(H=n())==null||H.publishState("rating"))}const g=a.type==="pickup"?Z("confirm_in_car_info"):Z("confirm_destination_info"),_=a.type==="pickup"?Z("confirm_in_car_button"):Z("confirm_destination_button");var v=Nn(),y=Bt(v),b=q(y,!0);C(y);var S=V(y,2);S.__click=l;var D=q(S,!0);C(S),ie(()=>{W(b,s()),W(D,d())}),X(t,v),Le(),c()}qe(["click"]);var Bn=J('<button type="button" class="star-btn svelte-139mv0"><img class="star svelte-139mv0"/></button>'),In=(t,a)=>{var e;ue.set(!0),se.set({key:"loading",params:{}}),(e=a())==null||e.publishState("map-idle")},Gn=J('<div class="rating-container svelte-139mv0"><div class="stars svelte-139mv0"></div> <div class="rating-label svelte-139mv0"> </div> <button class="skip-btn svelte-139mv0"> </button></div>');function En(t,a){Se(a,!0);const[e,c]=De(),r=()=>O(Te,"$mqttClient",e),u=()=>O(_,"$ratingRefuseText",e);let i=z(0),o=z(0),n=z(""),s=z("");Re(async()=>{L(n,await Nt("/star_filled.svg"),!0),L(s,await Nt("/star_empty.svg"),!0),ue.set(!1),se.set({key:"loading",params:{}})});function d(R){var M,k;L(i,R,!0),ue.set(!0),se.set({key:"loading",params:{}}),(M=r())==null||M.publishRating(p(i),new Date().toISOString()),(k=r())==null||k.publishState("map-idle")}function l(R){L(o,R,!0)}function g(){L(o,0)}Z("rating_heading");const _=Z("rating_refuse");var v=Gn(),y=q(v);xt(y,20,()=>Array.from({length:5}),At,(R,M,k)=>{var $=Bn();$.__click=()=>d(k+1),Oe($,"aria-label",`Rate ${k+1} star${k===0?"":"s"}`);var I=q($);Oe(I,"alt",k+1+" star"),C($),ie(()=>Oe(I,"src",(p(o)?k<p(o):k<p(i))?p(n):p(s))),wt("mouseenter",$,()=>l(k+1)),wt("mouseleave",$,g),X(R,$)}),C(y);var b=V(y,2),S=q(b,!0);C(b);var D=V(b,2);D.__click=[In,r];var x=q(D,!0);C(D),C(v),ie(()=>{W(S,p(i)>0?`${p(i)} / 5`:"PROMPT"),W(x,u())}),X(t,v),Le(),c()}qe(["click"]);var Kn=J('<div class="app-root"><!> <!></div>');function ai(t,a){Se(a,!0);const[e,c]=De(),r=()=>O(Te,"$mqttClient",e),u=()=>O(Me,"$carStatus",e),i=()=>O(be,"$appState",e),o=()=>O(hr,"$sessionId",e),n=()=>O(se,"$appGlobalLoadingMessageKey",e),s=()=>O(ue,"$appGlobalLoading",e),d=()=>O(p(v),"$appGlobalLoadingMessage",e);let l=z(!1),g=z(!1);Re(()=>{let M=null,k=0;return navigator.geolocation?M=navigator.geolocation.watchPosition($=>{const I=Date.now();I-k>=500&&($t.set({lat:$.coords.latitude,lng:$.coords.longitude}),k=I)},$=>{console.warn("Geolocation denied or unavailable:",$)},{enableHighAccuracy:!1,maximumAge:1e3,timeout:1e3}):($t.set(null),console.warn("Geolocation not supported")),()=>{M!==null&&navigator.geolocation.clearWatch(M)}}),ve(()=>{r()||pr("/login")});let _=null;ve(()=>{if(r()&&u()){if(u().state===_)return;switch(console.log("App state changed from",i(),"to",u().state),_=u().state,u().state){case"None":r().publishState("map-idle"),L(l,!0),be.set("map-idle");break;case"map-idle":L(l,!0),be.set("map-idle");break;case"spot-picking":L(l,!1),be.set("spot-picking");break;case"bus-stop-picking":L(l,!0),be.set("bus-stop-picking");break;case"driving-to-pickup":L(l,!0),be.set("driving-to-pickup");break;case"arrived-to-pickup":L(l,!0),be.set("arrived-to-pickup");break;case"driving-to-destination":L(l,!0),be.set("driving-to-destination");break;case"arrived-to-destination":L(l,!0),be.set("arrived-to-destination");break;case"rating":L(l,!1),be.set("rating");break;case"shutting-down":ue.set(!0),se.set({key:"car_shutting_down"}),L(g,!0),L(l,!1);const M=o()??"";mr.set({key:"session_closed",params:{id:M}}),Xa();break;default:L(l,!1),console.error("Unknown car status state:",JSON.stringify(u().state));break}}});const v=Yt(()=>n()?Z(n().key,n().params):null);var y=Kn(),b=q(y);{var S=M=>{$r(M,{children:(k,$)=>{var I=gr(),H=Bt(I);{var Q=G=>{xr(G,{})},E=(G,F)=>{{var Y=re=>{An(re,{})},ee=(re,oe)=>{{var de=K=>{ja(K,{type:"pickup"})},ne=(K,pe)=>{{var m=T=>{Ua(T,{type:"pickup"})},P=(T,B)=>{{var h=w=>{ja(w,{type:"destination"})},f=(w,A)=>{{var N=j=>{Ua(j,{type:"destination"})};te(w,j=>{i()==="arrived-to-destination"&&j(N)},A)}};te(T,w=>{i()==="driving-to-destination"?w(h):w(f,!1)},B)}};te(K,T=>{i()==="arrived-to-pickup"?T(m):T(P,!1)},pe)}};te(re,K=>{i()==="driving-to-pickup"?K(de):K(ne,!1)},oe)}};te(G,re=>{i()==="bus-stop-picking"?re(Y):re(ee,!1)},F)}};te(H,G=>{i()==="map-idle"?G(Q):G(E,!1)})}X(k,I)},$$slots:{default:!0}})},D=(M,k)=>{{var $=H=>{Sn(H,{})},I=(H,Q)=>{{var E=G=>{En(G,{})};te(H,G=>{i()==="rating"&&G(E)},Q)}};te(M,H=>{i()==="spot-picking"?H($):H(I,!1)},k)}};te(b,M=>{p(l)?M(S):M(D,!1)})}var x=V(b,2);{var R=M=>{Sr(M,{get loadingMsg(){return d()}})};te(x,M=>{s()&&M(R)})}C(y),X(t,y),Le(),c()}export{ai as component};
